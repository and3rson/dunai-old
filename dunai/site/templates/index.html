{% load static %}
{% load common %}
{% load thumbnail %}

<!DOCTYPE html>
<html>
    <head>
        <title>Andrew Dunai</title>
        <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400&amp;subset=cyrillic" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdn.rawgit.com/konpa/devicon/df6431e323547add1b4cf45992913f15286456d3/devicon.min.css" />
        <link rel="stylesheet" type="text/css" href="{% static 'css/normalize.css' %}" />
        <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}?10" />
        <link rel="stylesheet" type="text/css" href="{% static 'css/devicons.min.css' %}" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
    <body>
        <div class="main">
            <div class="splash">
                <div class="splash-inside" data-on-scroll="splash">
                    <div class="container">
                        <div class="header">
                            <h1 class="headline">Andrew</h1>
                            <h1 class="headline impact">Dunai</h1>
                            <h2 class="message">I do everything.</h2>
                        </div>
                    </div>
                </div>
            </div>
            <div class="companies" data-on-scroll="companies">
                <div class="container">
                    {% for company in cv.companies %}
                    <h2>
                        <img class="company-icon" src="{% static company.icon %}" />
                        <span class="company-role">{{ company.role }}</span>
                        <span class="company-name"><span class="hide-on-sm">@</span> {{ company.name }}</span>
                        <span class="company-date">{{ company.start|date:"b Y" }} - {% if company.end %}{{ company.end|date:"b Y" }}{% else %}now{% endif %}</span>
                    </h2>
                    <p class="company-descr">{{ company.description }}</p>
                    <div class="company-technologies">
                        {% for technology in company.technologies %}
                            <span class="technology">
                                {{ technology|icon }}
                            </span>
                        {% endfor %}
                    </div>
                    {% endfor %}
                </div>
            </div>
            <div class="container">
                <div class="row">
                    {% for feature in features %}
                        <div class="col">
                            <a href="#" class="feature nohl" data-image-url="{{ feature.photo.url }}">
                                <div class="cover" style="background-image: url({% thumbnail feature.photo 300x300 crop %})"></div>
                                <div class="note">{{ feature.comment|safe }}</div>
                            </a>
                        </div>
                    {% endfor %}
                </div>
            </div>
            <div class="container" --data-on-scroll="contacts">
                <div class="contacts">
                    <div class="contact linkedin">
                        <img src="{% static 'images/linkedin.png' %}" class="social" />
                        <span>
                            <a href="https://www.linkedin.com/in/dunai/">linkedin.com/in/dunai/</a>
                        </span>
                    </div>
                    <div class="contact email">
                        <img src="{% static 'images/email.png' %}" class="social" />
                        <span>
                            <a href="mailto:a@dun.ai">a@dun.ai</a>
                        </span>
                    </div>
                    <div class="contact phone">
                        <img src="{% static 'images/phone.png' %}" class="social" />
                        <span>
                            <a href="tel:+380633700097">+380633700097</a>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    <a href="#" class="popup nohl">
        <div class="popup-content nohl">
        </div>
        <div class="popup-note">
            <span data-if-desktop>Click</span><span data-if-mobile>Tap</span> anywhere to close.
        </div>
    </a>
    <script type="text/javascript">
        window.addEventListener('load', function() {
            // Misc helpers
            window.$ = selector => document.querySelector(selector);
            window.$$ = selector => Array.prototype.slice.call(document.querySelectorAll(selector));
            window.isMobile = 'ontouchstart' in window;
            window.clamp = (smin, smax, dmin, dmax, value) => {
                var k = (value - smin) / (smax - smin);
                return dmin + (dmax - dmin) * k;
            };

            // Pop-up
            var popup = $('.popup');
            var popupContent = $('.popup .popup-content');
            var stopPropagation = e => e.stopPropagation();
            window.addEventListener('scroll', e => {
                var factor = document.body.scrollTop / (document.body.clientHeight - window.innerHeight);
                /* document.body.style.backgroundColor = 'rgba('
                    + Math.round(clamp(0, 1, 8, 0, factor))
                    + ', '
                    + Math.round(clamp(0, 1, 8, 0, factor))
                    + ', '
                    + Math.round(clamp(0, 1, 0, 16, factor))
                    + ', 1)'
                ; */
            });
            $$('.feature').forEach(el => {
                el.addEventListener('click', e => {
                    var url = e.currentTarget.getAttribute('data-image-url');
                    e.preventDefault();
                    popup.setAttribute('class', 'popup visible');
                    popupContent.style.backgroundImage = 'url(' + url + ')';
                });
            });
            var hidePopup = e => {
                popup.setAttribute('class', 'popup');
                e.preventDefault();
            };
            popup.addEventListener('click', hidePopup);
            window.addEventListener('keydown', e => (e.keyCode == 27 || e.which == 27) ? hidePopup() : 0);
            $$('[data-if-desktop],[data-if-mobile]').filter(
                el => el.hasAttribute(isMobile ? 'data-if-desktop' : 'data-if-mobile')
            ).forEach(
                el => el.parentNode.removeChild(el)
            );
            tippy('[title]', {
                animation: 'perspective',
                duration: 90,
                size: 'large',
                theme: 'molokai',
                performance: true
            });
        });
    </script>
    <script src="https://unpkg.com/tippy.js@beta/dist/tippy.all.min.js"></script>
    </body>
</html>

